---
title: "Lab 04 - La Quinta is Spanish for next to Denny's, Pt. 1"
author: "Rachel Weiner"
date: "January 5, 2026"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 
data(dennys)
data(laquinta)
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```

Based on Mitch Hedberg joke that the hotel chain, "La Quinta" translates to "next to Denny's" as these two locations are commonly clustered together across American towns and cities. Let's see where this joke pans out according to the data. 

### Exercise 1

Let's start by collecting the dimensions of the denny's data set. 

```{r count_dennys_1}
nrow(dennys)
ncol(dennys)
```

There are 1643 rows in the data set which each represent a different Denny's restaurant location. There are also six columns in this data set which each represent a different variable regarding each Denny's location. The six variables include address, city, state, zip code, longitude and latitude. 

### Exercise 2

Next, let's see about the La Quinta data set. 

```{r count _laquinta}
nrow(laquinta)
ncol(laquinta)
```

There are 909 rows in this data set each representing a different La Quinta hotel location. There are also six columns each representing the same six variables as listed in the Denny's data set. (Address, city, state, zip code, longitude, and latitude)

### Exercise 3

There are many La Quinta hotels outside of the United States including Canada, Mexico, China, New Zealand, Georgia, and Turkiye. This information is clearly listed on their website.

On the otherhand, Denny's does not clearly list any restauraunts as being outside of the United States and makes clear that they are "America's Diner, In your Neighborhood" suggesting that they only have United States locations. They might have locations that are outside of the United States but this is not made clear via their website. 

### Exercise 4

As the answers above were based on each of the organization's websites, the data will provide a more substantive answer to the question regarding whether these organizations have locations outside of the United States. 

The first brainstormed idea that I came up with works with the state variable. I might be able to filter the data to reveal rows that did not have a state mentioned. This might help me to visualize which locations, of both companies, were not located within the United States. 

### Exercise 5

Using the filter() function, I will find whether there are any Denny's locations outside of the United States. 

```{r filter_variable}
dennys %>%
  filter(!(state %in% states$abbreviation))
```

Based off of this, there are no Denny's locations outside of the United States from this data set. 

### Exercise 6

Now I will add a seventh variable to the Dennys data set to reflect the country in which each restaurant is located, which is the United States for all locations. 

```{r mutate_variable}
dennys <- dennys %>%
  mutate(country = "United States")
```

### Exercise 7

Next, I will do some research to find the La Quinta hotel locations that fall outside of the United States. This will help us with the next exercise.

### Exercise 8

Now that I have an idea and some notes regarding La Quinta locations outside of the United States, I will use the case_when function to populate this variable. 
```{r cases}
laquinta <- laquinta %>%
  mutate(country = case_when(
    state %in% state.abb ~ "United States",
    state %in% c("ON", "BC") ~ "Canada",
    state == "ANT" ~ "Colombia",
    state == "AG" ~ "Antigua and Barbuda",
    state == "CH" ~ "Switzerland",
    state == "FM" ~ "Micronesia", 
    state == "PU" ~ "Guinea-Bissau",
    state == "QR" ~ "Qatar",
    state == "SL" ~ "Sierra Leone",
    state == "VE" ~ "Venezuela"))
```

As there are no Denny's locations outside the United States, we are not concerned with filtering locations for that data set. La Quinta, on the other hand, does have locations outside of the United States and therefore we will need to filter this data set for only locations in the United States. 
```{r filter}
laquinta <- laquinta %>%
  filter(country == "United States")
```

### Exercise 9

Now we will calculate which states have the most and fewest Denny's locations. 

```{r count_dennys}
dennys %>% 
  count(state, sort = TRUE)
data(dennys)
```

```{r arrange_dennys}
dennys2 <- dennys %>% 
  count(state)
```

According to these data calculations, California has (by far) the most Denny's locations with 403 total locations in the state. On the other hand, Delaware has the fewest Denny's locations with a grand total of one location. This is not surprising as California is one of the largest states and Delaware is one of the smallest states, by land area. 

```{r join_datasets}
dennys2 <- dennys2 %>%
  count(state) %>%
  inner_join(states, by = c("state" = "abbreviation"))
```

This joined code allows us to learn exactly how many observations are in each state using both the "states" data frame and the "dennys" data frame.

### Exercise 10

Now that we have joined the two data sets, we are interested in learning which state has the most Dennys location per 1000 square miles. 

```{r density_dennys}
dennys2 <- dennys2 %>%
  mutate(density_per_1000 = (n / area) * 1000) %>%
  arrange(desc(density_per_1000)) %>%
  print()
```
According to our data output. Washington D.C. has the greatest number of Dennys locations per 1000 square miles with 2 restaurants spanning 68.34 square miles.

On to La Quinta locations!

```{r join_laquinta}
laquinta2 <- laquinta %>%
  count(state) %>%
  inner_join(states, by = c("state" = "abbreviation"))
```

```{r density_laquinta}
laquinta2 <- laquinta2 %>%
  mutate(density_per_1000 = (n / area) * 1000) %>%
  arrange(desc(density_per_1000)) %>%
  print()
```
Rhode Island is home to the most La Quinta locations per 1000 square miles with one location across 1545 square miles. 

Next, we will do some final code to create a scatterplot of all Dennys restaraunt locations and all La Quinta hotel locations within the United States. 

```{r}
dennys <- dennys %>%
  mutate(establishment = "Denny's")
laquinta <- laquinta %>%
  mutate(establishment = "La Quinta")
```

```{r}
dn_lq <- bind_rows(dennys, laquinta)
```

```{r combinding_datasets}
dn_lq %>%
  ggplot(dn_lq, mapping = aes(
  x = longitude,
  y = latitude,
  color = establishment
)) +
  geom_point()
```

As we have plotted longitude and latitude, we are able to clearly visualize both company locations on a map-like visualization, how cool!?

### Exercise 11

Let us see about North Carolina locations. 

```{r nc_locations}
dn_lq_nc <- dn_lq %>%
  filter(state == "NC")
```

```{r nc_map}
dn_lq_nc%>%
  ggplot(dn_lq, mapping = aes(
  x = longitude,
  y = latitude,
  color = establishment
)) +
  geom_point(alpha = .5)
```

This visualization graphs only the North Carolina Denny's and La Quinta locations. Visually, Mitch Hedberg's joke does not appear to hold as many of the Denny's locations and most of the La Quinta locations do not cluster in the same locations on the graph and are largely stand alone. 

### Exercise 12

How about Texas?

```{r tx_locations}
dn_lq_tx <- dn_lq %>%
  filter(state == "TX")
```

```{r tx_map}
dn_lq_tx%>%
  ggplot(dn_lq, mapping = aes(
  x = longitude,
  y = latitude,
  color = establishment
)) +
  geom_point(alpha = .5)
```

According to this data visualization of Texas Denny's and La Quinta locations, Mitch Hedberg's joke does appear to hold as most Denny's and La Quinta locations do cluster around each other. 

Maybe the joke holds true depending on the state that you are in!

Thank you!
